var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __name = (target, value) => __defProp(target, "name", { value, configurable: true });
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, "default"), secondTarget && __copyProps(secondTarget, mod, "default"));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var zkgroup_exports = {};
__export(zkgroup_exports, {
  createProfileKeyCredentialPresentation: () => createProfileKeyCredentialPresentation,
  decryptGroupBlob: () => decryptGroupBlob,
  decryptProfileKey: () => decryptProfileKey,
  decryptProfileKeyCredentialPresentation: () => decryptProfileKeyCredentialPresentation,
  decryptUuid: () => decryptUuid,
  deriveGroupID: () => deriveGroupID,
  deriveGroupPublicParams: () => deriveGroupPublicParams,
  deriveGroupSecretParams: () => deriveGroupSecretParams,
  deriveProfileKeyCommitment: () => deriveProfileKeyCommitment,
  deriveProfileKeyVersion: () => deriveProfileKeyVersion,
  encryptGroupBlob: () => encryptGroupBlob,
  encryptUuid: () => encryptUuid,
  generateProfileKeyCredentialRequest: () => generateProfileKeyCredentialRequest,
  getAuthCredentialPresentation: () => getAuthCredentialPresentation,
  getClientZkAuthOperations: () => getClientZkAuthOperations,
  getClientZkGroupCipher: () => getClientZkGroupCipher,
  getClientZkProfileOperations: () => getClientZkProfileOperations,
  handleProfileKeyCredential: () => handleProfileKeyCredential,
  verifyNotarySignature: () => verifyNotarySignature
});
module.exports = __toCommonJS(zkgroup_exports);
var import_zkgroup = require("@signalapp/libsignal-client/zkgroup");
var import_UUID = require("../types/UUID");
__reExport(zkgroup_exports, require("@signalapp/libsignal-client/zkgroup"), module.exports);
function decryptGroupBlob(clientZkGroupCipher, ciphertext) {
  return clientZkGroupCipher.decryptBlob(Buffer.from(ciphertext));
}
function decryptProfileKeyCredentialPresentation(clientZkGroupCipher, presentationBuffer) {
  const presentation = new import_zkgroup.ProfileKeyCredentialPresentation(Buffer.from(presentationBuffer));
  const uuidCiphertext = presentation.getUuidCiphertext();
  const uuid = clientZkGroupCipher.decryptUuid(uuidCiphertext);
  const profileKeyCiphertext = presentation.getProfileKeyCiphertext();
  const profileKey = clientZkGroupCipher.decryptProfileKey(profileKeyCiphertext, uuid);
  return {
    profileKey: profileKey.serialize(),
    uuid: import_UUID.UUID.cast(uuid)
  };
}
function decryptProfileKey(clientZkGroupCipher, profileKeyCiphertextBuffer, uuid) {
  const profileKeyCiphertext = new import_zkgroup.ProfileKeyCiphertext(Buffer.from(profileKeyCiphertextBuffer));
  const profileKey = clientZkGroupCipher.decryptProfileKey(profileKeyCiphertext, uuid);
  return profileKey.serialize();
}
function decryptUuid(clientZkGroupCipher, uuidCiphertextBuffer) {
  const uuidCiphertext = new import_zkgroup.UuidCiphertext(Buffer.from(uuidCiphertextBuffer));
  return clientZkGroupCipher.decryptUuid(uuidCiphertext);
}
function deriveProfileKeyVersion(profileKeyBase64, uuid) {
  const profileKeyArray = Buffer.from(profileKeyBase64, "base64");
  const profileKey = new import_zkgroup.ProfileKey(profileKeyArray);
  const profileKeyVersion = profileKey.getProfileKeyVersion(uuid);
  return profileKeyVersion.toString();
}
function deriveGroupPublicParams(groupSecretParamsBuffer) {
  const groupSecretParams = new import_zkgroup.GroupSecretParams(Buffer.from(groupSecretParamsBuffer));
  return groupSecretParams.getPublicParams().serialize();
}
function deriveGroupID(groupSecretParamsBuffer) {
  const groupSecretParams = new import_zkgroup.GroupSecretParams(Buffer.from(groupSecretParamsBuffer));
  return groupSecretParams.getPublicParams().getGroupIdentifier().serialize();
}
function deriveGroupSecretParams(masterKeyBuffer) {
  const masterKey = new import_zkgroup.GroupMasterKey(Buffer.from(masterKeyBuffer));
  const groupSecretParams = import_zkgroup.GroupSecretParams.deriveFromMasterKey(masterKey);
  return groupSecretParams.serialize();
}
function encryptGroupBlob(clientZkGroupCipher, plaintext) {
  return clientZkGroupCipher.encryptBlob(Buffer.from(plaintext));
}
function encryptUuid(clientZkGroupCipher, uuidPlaintext) {
  const uuidCiphertext = clientZkGroupCipher.encryptUuid(uuidPlaintext);
  return uuidCiphertext.serialize();
}
function generateProfileKeyCredentialRequest(clientZkProfileCipher, uuid, profileKeyBase64) {
  const profileKeyArray = Buffer.from(profileKeyBase64, "base64");
  const profileKey = new import_zkgroup.ProfileKey(profileKeyArray);
  const context = clientZkProfileCipher.createProfileKeyCredentialRequestContext(uuid, profileKey);
  const request = context.getRequest();
  const requestArray = request.serialize();
  return {
    context,
    requestHex: requestArray.toString("hex")
  };
}
function getAuthCredentialPresentation(clientZkAuthOperations, authCredentialBase64, groupSecretParamsBase64) {
  const authCredential = new import_zkgroup.AuthCredential(Buffer.from(authCredentialBase64, "base64"));
  const secretParams = new import_zkgroup.GroupSecretParams(Buffer.from(groupSecretParamsBase64, "base64"));
  const presentation = clientZkAuthOperations.createAuthCredentialPresentation(secretParams, authCredential);
  return presentation.serialize();
}
function createProfileKeyCredentialPresentation(clientZkProfileCipher, profileKeyCredentialBase64, groupSecretParamsBase64) {
  const profileKeyCredentialArray = Buffer.from(profileKeyCredentialBase64, "base64");
  const profileKeyCredential = new import_zkgroup.ProfileKeyCredential(profileKeyCredentialArray);
  const secretParams = new import_zkgroup.GroupSecretParams(Buffer.from(groupSecretParamsBase64, "base64"));
  const presentation = clientZkProfileCipher.createProfileKeyCredentialPresentation(secretParams, profileKeyCredential);
  return presentation.serialize();
}
function getClientZkAuthOperations(serverPublicParamsBase64) {
  const serverPublicParams = new import_zkgroup.ServerPublicParams(Buffer.from(serverPublicParamsBase64, "base64"));
  return new import_zkgroup.ClientZkAuthOperations(serverPublicParams);
}
function getClientZkGroupCipher(groupSecretParamsBase64) {
  const serverPublicParams = new import_zkgroup.GroupSecretParams(Buffer.from(groupSecretParamsBase64, "base64"));
  return new import_zkgroup.ClientZkGroupCipher(serverPublicParams);
}
function getClientZkProfileOperations(serverPublicParamsBase64) {
  const serverPublicParams = new import_zkgroup.ServerPublicParams(Buffer.from(serverPublicParamsBase64, "base64"));
  return new import_zkgroup.ClientZkProfileOperations(serverPublicParams);
}
function handleProfileKeyCredential(clientZkProfileCipher, context, responseBase64) {
  const response = new import_zkgroup.ProfileKeyCredentialResponse(Buffer.from(responseBase64, "base64"));
  const profileKeyCredential = clientZkProfileCipher.receiveProfileKeyCredential(context, response);
  const credentialArray = profileKeyCredential.serialize();
  return credentialArray.toString("base64");
}
function deriveProfileKeyCommitment(profileKeyBase64, uuid) {
  const profileKeyArray = Buffer.from(profileKeyBase64, "base64");
  const profileKey = new import_zkgroup.ProfileKey(profileKeyArray);
  return profileKey.getCommitment(uuid).contents.toString("base64");
}
function verifyNotarySignature(serverPublicParamsBase64, message, signature) {
  const serverPublicParams = new import_zkgroup.ServerPublicParams(Buffer.from(serverPublicParamsBase64, "base64"));
  const notarySignature = new import_zkgroup.NotarySignature(Buffer.from(signature));
  serverPublicParams.verifySignature(Buffer.from(message), notarySignature);
}
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  createProfileKeyCredentialPresentation,
  decryptGroupBlob,
  decryptProfileKey,
  decryptProfileKeyCredentialPresentation,
  decryptUuid,
  deriveGroupID,
  deriveGroupPublicParams,
  deriveGroupSecretParams,
  deriveProfileKeyCommitment,
  deriveProfileKeyVersion,
  encryptGroupBlob,
  encryptUuid,
  generateProfileKeyCredentialRequest,
  getAuthCredentialPresentation,
  getClientZkAuthOperations,
  getClientZkGroupCipher,
  getClientZkProfileOperations,
  handleProfileKeyCredential,
  verifyNotarySignature
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiemtncm91cC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMSBTaWduYWwgTWVzc2VuZ2VyLCBMTENcbi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBR1BMLTMuMC1vbmx5XG5cbmltcG9ydCB0eXBlIHsgUHJvZmlsZUtleUNyZWRlbnRpYWxSZXF1ZXN0Q29udGV4dCB9IGZyb20gJ0BzaWduYWxhcHAvbGlic2lnbmFsLWNsaWVudC96a2dyb3VwJztcbmltcG9ydCB7XG4gIEF1dGhDcmVkZW50aWFsLFxuICBDbGllbnRaa0F1dGhPcGVyYXRpb25zLFxuICBDbGllbnRaa0dyb3VwQ2lwaGVyLFxuICBDbGllbnRaa1Byb2ZpbGVPcGVyYXRpb25zLFxuICBHcm91cE1hc3RlcktleSxcbiAgR3JvdXBTZWNyZXRQYXJhbXMsXG4gIFByb2ZpbGVLZXksXG4gIFByb2ZpbGVLZXlDaXBoZXJ0ZXh0LFxuICBQcm9maWxlS2V5Q3JlZGVudGlhbCxcbiAgUHJvZmlsZUtleUNyZWRlbnRpYWxQcmVzZW50YXRpb24sXG4gIFByb2ZpbGVLZXlDcmVkZW50aWFsUmVzcG9uc2UsXG4gIFNlcnZlclB1YmxpY1BhcmFtcyxcbiAgVXVpZENpcGhlcnRleHQsXG4gIE5vdGFyeVNpZ25hdHVyZSxcbn0gZnJvbSAnQHNpZ25hbGFwcC9saWJzaWduYWwtY2xpZW50L3prZ3JvdXAnO1xuaW1wb3J0IHsgVVVJRCB9IGZyb20gJy4uL3R5cGVzL1VVSUQnO1xuaW1wb3J0IHR5cGUgeyBVVUlEU3RyaW5nVHlwZSB9IGZyb20gJy4uL3R5cGVzL1VVSUQnO1xuXG5leHBvcnQgKiBmcm9tICdAc2lnbmFsYXBwL2xpYnNpZ25hbC1jbGllbnQvemtncm91cCc7XG5cbi8vIFNjZW5hcmlvc1xuXG5leHBvcnQgZnVuY3Rpb24gZGVjcnlwdEdyb3VwQmxvYihcbiAgY2xpZW50WmtHcm91cENpcGhlcjogQ2xpZW50WmtHcm91cENpcGhlcixcbiAgY2lwaGVydGV4dDogVWludDhBcnJheVxuKTogVWludDhBcnJheSB7XG4gIHJldHVybiBjbGllbnRaa0dyb3VwQ2lwaGVyLmRlY3J5cHRCbG9iKEJ1ZmZlci5mcm9tKGNpcGhlcnRleHQpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY3J5cHRQcm9maWxlS2V5Q3JlZGVudGlhbFByZXNlbnRhdGlvbihcbiAgY2xpZW50WmtHcm91cENpcGhlcjogQ2xpZW50WmtHcm91cENpcGhlcixcbiAgcHJlc2VudGF0aW9uQnVmZmVyOiBVaW50OEFycmF5XG4pOiB7IHByb2ZpbGVLZXk6IFVpbnQ4QXJyYXk7IHV1aWQ6IFVVSURTdHJpbmdUeXBlIH0ge1xuICBjb25zdCBwcmVzZW50YXRpb24gPSBuZXcgUHJvZmlsZUtleUNyZWRlbnRpYWxQcmVzZW50YXRpb24oXG4gICAgQnVmZmVyLmZyb20ocHJlc2VudGF0aW9uQnVmZmVyKVxuICApO1xuXG4gIGNvbnN0IHV1aWRDaXBoZXJ0ZXh0ID0gcHJlc2VudGF0aW9uLmdldFV1aWRDaXBoZXJ0ZXh0KCk7XG4gIGNvbnN0IHV1aWQgPSBjbGllbnRaa0dyb3VwQ2lwaGVyLmRlY3J5cHRVdWlkKHV1aWRDaXBoZXJ0ZXh0KTtcblxuICBjb25zdCBwcm9maWxlS2V5Q2lwaGVydGV4dCA9IHByZXNlbnRhdGlvbi5nZXRQcm9maWxlS2V5Q2lwaGVydGV4dCgpO1xuICBjb25zdCBwcm9maWxlS2V5ID0gY2xpZW50WmtHcm91cENpcGhlci5kZWNyeXB0UHJvZmlsZUtleShcbiAgICBwcm9maWxlS2V5Q2lwaGVydGV4dCxcbiAgICB1dWlkXG4gICk7XG5cbiAgcmV0dXJuIHtcbiAgICBwcm9maWxlS2V5OiBwcm9maWxlS2V5LnNlcmlhbGl6ZSgpLFxuICAgIHV1aWQ6IFVVSUQuY2FzdCh1dWlkKSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY3J5cHRQcm9maWxlS2V5KFxuICBjbGllbnRaa0dyb3VwQ2lwaGVyOiBDbGllbnRaa0dyb3VwQ2lwaGVyLFxuICBwcm9maWxlS2V5Q2lwaGVydGV4dEJ1ZmZlcjogVWludDhBcnJheSxcbiAgdXVpZDogVVVJRFN0cmluZ1R5cGVcbik6IFVpbnQ4QXJyYXkge1xuICBjb25zdCBwcm9maWxlS2V5Q2lwaGVydGV4dCA9IG5ldyBQcm9maWxlS2V5Q2lwaGVydGV4dChcbiAgICBCdWZmZXIuZnJvbShwcm9maWxlS2V5Q2lwaGVydGV4dEJ1ZmZlcilcbiAgKTtcblxuICBjb25zdCBwcm9maWxlS2V5ID0gY2xpZW50WmtHcm91cENpcGhlci5kZWNyeXB0UHJvZmlsZUtleShcbiAgICBwcm9maWxlS2V5Q2lwaGVydGV4dCxcbiAgICB1dWlkXG4gICk7XG5cbiAgcmV0dXJuIHByb2ZpbGVLZXkuc2VyaWFsaXplKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNyeXB0VXVpZChcbiAgY2xpZW50WmtHcm91cENpcGhlcjogQ2xpZW50WmtHcm91cENpcGhlcixcbiAgdXVpZENpcGhlcnRleHRCdWZmZXI6IFVpbnQ4QXJyYXlcbik6IHN0cmluZyB7XG4gIGNvbnN0IHV1aWRDaXBoZXJ0ZXh0ID0gbmV3IFV1aWRDaXBoZXJ0ZXh0KEJ1ZmZlci5mcm9tKHV1aWRDaXBoZXJ0ZXh0QnVmZmVyKSk7XG5cbiAgcmV0dXJuIGNsaWVudFprR3JvdXBDaXBoZXIuZGVjcnlwdFV1aWQodXVpZENpcGhlcnRleHQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVyaXZlUHJvZmlsZUtleVZlcnNpb24oXG4gIHByb2ZpbGVLZXlCYXNlNjQ6IHN0cmluZyxcbiAgdXVpZDogVVVJRFN0cmluZ1R5cGVcbik6IHN0cmluZyB7XG4gIGNvbnN0IHByb2ZpbGVLZXlBcnJheSA9IEJ1ZmZlci5mcm9tKHByb2ZpbGVLZXlCYXNlNjQsICdiYXNlNjQnKTtcbiAgY29uc3QgcHJvZmlsZUtleSA9IG5ldyBQcm9maWxlS2V5KHByb2ZpbGVLZXlBcnJheSk7XG5cbiAgY29uc3QgcHJvZmlsZUtleVZlcnNpb24gPSBwcm9maWxlS2V5LmdldFByb2ZpbGVLZXlWZXJzaW9uKHV1aWQpO1xuXG4gIHJldHVybiBwcm9maWxlS2V5VmVyc2lvbi50b1N0cmluZygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVyaXZlR3JvdXBQdWJsaWNQYXJhbXMoXG4gIGdyb3VwU2VjcmV0UGFyYW1zQnVmZmVyOiBVaW50OEFycmF5XG4pOiBVaW50OEFycmF5IHtcbiAgY29uc3QgZ3JvdXBTZWNyZXRQYXJhbXMgPSBuZXcgR3JvdXBTZWNyZXRQYXJhbXMoXG4gICAgQnVmZmVyLmZyb20oZ3JvdXBTZWNyZXRQYXJhbXNCdWZmZXIpXG4gICk7XG5cbiAgcmV0dXJuIGdyb3VwU2VjcmV0UGFyYW1zLmdldFB1YmxpY1BhcmFtcygpLnNlcmlhbGl6ZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVyaXZlR3JvdXBJRChncm91cFNlY3JldFBhcmFtc0J1ZmZlcjogVWludDhBcnJheSk6IFVpbnQ4QXJyYXkge1xuICBjb25zdCBncm91cFNlY3JldFBhcmFtcyA9IG5ldyBHcm91cFNlY3JldFBhcmFtcyhcbiAgICBCdWZmZXIuZnJvbShncm91cFNlY3JldFBhcmFtc0J1ZmZlcilcbiAgKTtcblxuICByZXR1cm4gZ3JvdXBTZWNyZXRQYXJhbXMuZ2V0UHVibGljUGFyYW1zKCkuZ2V0R3JvdXBJZGVudGlmaWVyKCkuc2VyaWFsaXplKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXJpdmVHcm91cFNlY3JldFBhcmFtcyhcbiAgbWFzdGVyS2V5QnVmZmVyOiBVaW50OEFycmF5XG4pOiBVaW50OEFycmF5IHtcbiAgY29uc3QgbWFzdGVyS2V5ID0gbmV3IEdyb3VwTWFzdGVyS2V5KEJ1ZmZlci5mcm9tKG1hc3RlcktleUJ1ZmZlcikpO1xuICBjb25zdCBncm91cFNlY3JldFBhcmFtcyA9IEdyb3VwU2VjcmV0UGFyYW1zLmRlcml2ZUZyb21NYXN0ZXJLZXkobWFzdGVyS2V5KTtcblxuICByZXR1cm4gZ3JvdXBTZWNyZXRQYXJhbXMuc2VyaWFsaXplKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmNyeXB0R3JvdXBCbG9iKFxuICBjbGllbnRaa0dyb3VwQ2lwaGVyOiBDbGllbnRaa0dyb3VwQ2lwaGVyLFxuICBwbGFpbnRleHQ6IFVpbnQ4QXJyYXlcbik6IFVpbnQ4QXJyYXkge1xuICByZXR1cm4gY2xpZW50WmtHcm91cENpcGhlci5lbmNyeXB0QmxvYihCdWZmZXIuZnJvbShwbGFpbnRleHQpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuY3J5cHRVdWlkKFxuICBjbGllbnRaa0dyb3VwQ2lwaGVyOiBDbGllbnRaa0dyb3VwQ2lwaGVyLFxuICB1dWlkUGxhaW50ZXh0OiBVVUlEU3RyaW5nVHlwZVxuKTogVWludDhBcnJheSB7XG4gIGNvbnN0IHV1aWRDaXBoZXJ0ZXh0ID0gY2xpZW50WmtHcm91cENpcGhlci5lbmNyeXB0VXVpZCh1dWlkUGxhaW50ZXh0KTtcblxuICByZXR1cm4gdXVpZENpcGhlcnRleHQuc2VyaWFsaXplKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVByb2ZpbGVLZXlDcmVkZW50aWFsUmVxdWVzdChcbiAgY2xpZW50WmtQcm9maWxlQ2lwaGVyOiBDbGllbnRaa1Byb2ZpbGVPcGVyYXRpb25zLFxuICB1dWlkOiBVVUlEU3RyaW5nVHlwZSxcbiAgcHJvZmlsZUtleUJhc2U2NDogc3RyaW5nXG4pOiB7IGNvbnRleHQ6IFByb2ZpbGVLZXlDcmVkZW50aWFsUmVxdWVzdENvbnRleHQ7IHJlcXVlc3RIZXg6IHN0cmluZyB9IHtcbiAgY29uc3QgcHJvZmlsZUtleUFycmF5ID0gQnVmZmVyLmZyb20ocHJvZmlsZUtleUJhc2U2NCwgJ2Jhc2U2NCcpO1xuICBjb25zdCBwcm9maWxlS2V5ID0gbmV3IFByb2ZpbGVLZXkocHJvZmlsZUtleUFycmF5KTtcblxuICBjb25zdCBjb250ZXh0ID1cbiAgICBjbGllbnRaa1Byb2ZpbGVDaXBoZXIuY3JlYXRlUHJvZmlsZUtleUNyZWRlbnRpYWxSZXF1ZXN0Q29udGV4dChcbiAgICAgIHV1aWQsXG4gICAgICBwcm9maWxlS2V5XG4gICAgKTtcbiAgY29uc3QgcmVxdWVzdCA9IGNvbnRleHQuZ2V0UmVxdWVzdCgpO1xuICBjb25zdCByZXF1ZXN0QXJyYXkgPSByZXF1ZXN0LnNlcmlhbGl6ZSgpO1xuXG4gIHJldHVybiB7XG4gICAgY29udGV4dCxcbiAgICByZXF1ZXN0SGV4OiByZXF1ZXN0QXJyYXkudG9TdHJpbmcoJ2hleCcpLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXV0aENyZWRlbnRpYWxQcmVzZW50YXRpb24oXG4gIGNsaWVudFprQXV0aE9wZXJhdGlvbnM6IENsaWVudFprQXV0aE9wZXJhdGlvbnMsXG4gIGF1dGhDcmVkZW50aWFsQmFzZTY0OiBzdHJpbmcsXG4gIGdyb3VwU2VjcmV0UGFyYW1zQmFzZTY0OiBzdHJpbmdcbik6IFVpbnQ4QXJyYXkge1xuICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IG5ldyBBdXRoQ3JlZGVudGlhbChcbiAgICBCdWZmZXIuZnJvbShhdXRoQ3JlZGVudGlhbEJhc2U2NCwgJ2Jhc2U2NCcpXG4gICk7XG4gIGNvbnN0IHNlY3JldFBhcmFtcyA9IG5ldyBHcm91cFNlY3JldFBhcmFtcyhcbiAgICBCdWZmZXIuZnJvbShncm91cFNlY3JldFBhcmFtc0Jhc2U2NCwgJ2Jhc2U2NCcpXG4gICk7XG5cbiAgY29uc3QgcHJlc2VudGF0aW9uID0gY2xpZW50WmtBdXRoT3BlcmF0aW9ucy5jcmVhdGVBdXRoQ3JlZGVudGlhbFByZXNlbnRhdGlvbihcbiAgICBzZWNyZXRQYXJhbXMsXG4gICAgYXV0aENyZWRlbnRpYWxcbiAgKTtcbiAgcmV0dXJuIHByZXNlbnRhdGlvbi5zZXJpYWxpemUoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb2ZpbGVLZXlDcmVkZW50aWFsUHJlc2VudGF0aW9uKFxuICBjbGllbnRaa1Byb2ZpbGVDaXBoZXI6IENsaWVudFprUHJvZmlsZU9wZXJhdGlvbnMsXG4gIHByb2ZpbGVLZXlDcmVkZW50aWFsQmFzZTY0OiBzdHJpbmcsXG4gIGdyb3VwU2VjcmV0UGFyYW1zQmFzZTY0OiBzdHJpbmdcbik6IFVpbnQ4QXJyYXkge1xuICBjb25zdCBwcm9maWxlS2V5Q3JlZGVudGlhbEFycmF5ID0gQnVmZmVyLmZyb20oXG4gICAgcHJvZmlsZUtleUNyZWRlbnRpYWxCYXNlNjQsXG4gICAgJ2Jhc2U2NCdcbiAgKTtcbiAgY29uc3QgcHJvZmlsZUtleUNyZWRlbnRpYWwgPSBuZXcgUHJvZmlsZUtleUNyZWRlbnRpYWwoXG4gICAgcHJvZmlsZUtleUNyZWRlbnRpYWxBcnJheVxuICApO1xuICBjb25zdCBzZWNyZXRQYXJhbXMgPSBuZXcgR3JvdXBTZWNyZXRQYXJhbXMoXG4gICAgQnVmZmVyLmZyb20oZ3JvdXBTZWNyZXRQYXJhbXNCYXNlNjQsICdiYXNlNjQnKVxuICApO1xuXG4gIGNvbnN0IHByZXNlbnRhdGlvbiA9XG4gICAgY2xpZW50WmtQcm9maWxlQ2lwaGVyLmNyZWF0ZVByb2ZpbGVLZXlDcmVkZW50aWFsUHJlc2VudGF0aW9uKFxuICAgICAgc2VjcmV0UGFyYW1zLFxuICAgICAgcHJvZmlsZUtleUNyZWRlbnRpYWxcbiAgICApO1xuXG4gIHJldHVybiBwcmVzZW50YXRpb24uc2VyaWFsaXplKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRaa0F1dGhPcGVyYXRpb25zKFxuICBzZXJ2ZXJQdWJsaWNQYXJhbXNCYXNlNjQ6IHN0cmluZ1xuKTogQ2xpZW50WmtBdXRoT3BlcmF0aW9ucyB7XG4gIGNvbnN0IHNlcnZlclB1YmxpY1BhcmFtcyA9IG5ldyBTZXJ2ZXJQdWJsaWNQYXJhbXMoXG4gICAgQnVmZmVyLmZyb20oc2VydmVyUHVibGljUGFyYW1zQmFzZTY0LCAnYmFzZTY0JylcbiAgKTtcblxuICByZXR1cm4gbmV3IENsaWVudFprQXV0aE9wZXJhdGlvbnMoc2VydmVyUHVibGljUGFyYW1zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENsaWVudFprR3JvdXBDaXBoZXIoXG4gIGdyb3VwU2VjcmV0UGFyYW1zQmFzZTY0OiBzdHJpbmdcbik6IENsaWVudFprR3JvdXBDaXBoZXIge1xuICBjb25zdCBzZXJ2ZXJQdWJsaWNQYXJhbXMgPSBuZXcgR3JvdXBTZWNyZXRQYXJhbXMoXG4gICAgQnVmZmVyLmZyb20oZ3JvdXBTZWNyZXRQYXJhbXNCYXNlNjQsICdiYXNlNjQnKVxuICApO1xuXG4gIHJldHVybiBuZXcgQ2xpZW50WmtHcm91cENpcGhlcihzZXJ2ZXJQdWJsaWNQYXJhbXMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2xpZW50WmtQcm9maWxlT3BlcmF0aW9ucyhcbiAgc2VydmVyUHVibGljUGFyYW1zQmFzZTY0OiBzdHJpbmdcbik6IENsaWVudFprUHJvZmlsZU9wZXJhdGlvbnMge1xuICBjb25zdCBzZXJ2ZXJQdWJsaWNQYXJhbXMgPSBuZXcgU2VydmVyUHVibGljUGFyYW1zKFxuICAgIEJ1ZmZlci5mcm9tKHNlcnZlclB1YmxpY1BhcmFtc0Jhc2U2NCwgJ2Jhc2U2NCcpXG4gICk7XG5cbiAgcmV0dXJuIG5ldyBDbGllbnRaa1Byb2ZpbGVPcGVyYXRpb25zKHNlcnZlclB1YmxpY1BhcmFtcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVQcm9maWxlS2V5Q3JlZGVudGlhbChcbiAgY2xpZW50WmtQcm9maWxlQ2lwaGVyOiBDbGllbnRaa1Byb2ZpbGVPcGVyYXRpb25zLFxuICBjb250ZXh0OiBQcm9maWxlS2V5Q3JlZGVudGlhbFJlcXVlc3RDb250ZXh0LFxuICByZXNwb25zZUJhc2U2NDogc3RyaW5nXG4pOiBzdHJpbmcge1xuICBjb25zdCByZXNwb25zZSA9IG5ldyBQcm9maWxlS2V5Q3JlZGVudGlhbFJlc3BvbnNlKFxuICAgIEJ1ZmZlci5mcm9tKHJlc3BvbnNlQmFzZTY0LCAnYmFzZTY0JylcbiAgKTtcbiAgY29uc3QgcHJvZmlsZUtleUNyZWRlbnRpYWwgPVxuICAgIGNsaWVudFprUHJvZmlsZUNpcGhlci5yZWNlaXZlUHJvZmlsZUtleUNyZWRlbnRpYWwoY29udGV4dCwgcmVzcG9uc2UpO1xuXG4gIGNvbnN0IGNyZWRlbnRpYWxBcnJheSA9IHByb2ZpbGVLZXlDcmVkZW50aWFsLnNlcmlhbGl6ZSgpO1xuXG4gIHJldHVybiBjcmVkZW50aWFsQXJyYXkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVyaXZlUHJvZmlsZUtleUNvbW1pdG1lbnQoXG4gIHByb2ZpbGVLZXlCYXNlNjQ6IHN0cmluZyxcbiAgdXVpZDogVVVJRFN0cmluZ1R5cGVcbik6IHN0cmluZyB7XG4gIGNvbnN0IHByb2ZpbGVLZXlBcnJheSA9IEJ1ZmZlci5mcm9tKHByb2ZpbGVLZXlCYXNlNjQsICdiYXNlNjQnKTtcbiAgY29uc3QgcHJvZmlsZUtleSA9IG5ldyBQcm9maWxlS2V5KHByb2ZpbGVLZXlBcnJheSk7XG5cbiAgcmV0dXJuIHByb2ZpbGVLZXkuZ2V0Q29tbWl0bWVudCh1dWlkKS5jb250ZW50cy50b1N0cmluZygnYmFzZTY0Jyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlOb3RhcnlTaWduYXR1cmUoXG4gIHNlcnZlclB1YmxpY1BhcmFtc0Jhc2U2NDogc3RyaW5nLFxuICBtZXNzYWdlOiBVaW50OEFycmF5LFxuICBzaWduYXR1cmU6IFVpbnQ4QXJyYXlcbik6IHZvaWQge1xuICBjb25zdCBzZXJ2ZXJQdWJsaWNQYXJhbXMgPSBuZXcgU2VydmVyUHVibGljUGFyYW1zKFxuICAgIEJ1ZmZlci5mcm9tKHNlcnZlclB1YmxpY1BhcmFtc0Jhc2U2NCwgJ2Jhc2U2NCcpXG4gICk7XG5cbiAgY29uc3Qgbm90YXJ5U2lnbmF0dXJlID0gbmV3IE5vdGFyeVNpZ25hdHVyZShCdWZmZXIuZnJvbShzaWduYXR1cmUpKTtcblxuICBzZXJ2ZXJQdWJsaWNQYXJhbXMudmVyaWZ5U2lnbmF0dXJlKEJ1ZmZlci5mcm9tKG1lc3NhZ2UpLCBub3RhcnlTaWduYXR1cmUpO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FB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
