var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var context_exports = {};
__export(context_exports, {
  SignalContext: () => SignalContext
});
module.exports = __toCommonJS(context_exports);
var import_electron = require("electron");
var import_Bytes = require("../context/Bytes");
var import_Crypto = require("../context/Crypto");
var import_Timers = require("../context/Timers");
var import_setupI18n = require("../util/setupI18n");
var import_environment = require("../environment");
var import_assert = require("../util/assert");
var import_preload = require("../util/preload");
var import_set_up_renderer_logging = require("../logging/set_up_renderer_logging");
var import_waitForSettingsChange = require("./waitForSettingsChange");
var import_createNativeThemeListener = require("../context/createNativeThemeListener");
var import_OS = require("../OS");
const params = new URLSearchParams(document.location.search);
const configParam = params.get("config");
(0, import_assert.strictAssert)(typeof configParam === "string", "config is not a string");
const config = JSON.parse(configParam);
const { locale } = config;
(0, import_assert.strictAssert)(locale, "locale could not be parsed from config");
(0, import_assert.strictAssert)(typeof locale === "string", "locale is not a string");
const localeMessages = import_electron.ipcRenderer.sendSync("locale-data");
(0, import_environment.setEnvironment)((0, import_environment.parseEnvironment)(config.environment));
(0, import_assert.strictAssert)(Boolean(window.SignalContext), "context must be defined");
(0, import_set_up_renderer_logging.initialize)();
const SignalContext = {
  Settings: {
    themeSetting: (0, import_preload.createSetting)("themeSetting", { setter: false }),
    waitForChange: import_waitForSettingsChange.waitForSettingsChange
  },
  OS: {
    platform: process.platform,
    isWindows: import_OS.isWindows,
    isWindows11: import_OS.isWindows11,
    isLinux: import_OS.isLinux,
    isMacOS: import_OS.isMacOS
  },
  bytes: new import_Bytes.Bytes(),
  config,
  crypto: new import_Crypto.Crypto(),
  getAppInstance: () => config.appInstance ? String(config.appInstance) : void 0,
  getEnvironment: import_environment.getEnvironment,
  getNodeVersion: () => String(config.nodeVersion),
  getVersion: () => String(config.version),
  getPath: (name) => {
    return String(config[`${name}Path`]);
  },
  i18n: (0, import_setupI18n.setupI18n)(locale, localeMessages),
  localeMessages,
  log: window.SignalContext.log,
  nativeThemeListener: (0, import_createNativeThemeListener.createNativeThemeListener)(import_electron.ipcRenderer, window),
  setIsCallActive(isCallActive) {
    import_electron.ipcRenderer.send("set-is-call-active", isCallActive);
  },
  timers: new import_Timers.Timers(),
  async executeMenuRole(role) {
    await import_electron.ipcRenderer.invoke("executeMenuRole", role);
  },
  async getMainWindowStats() {
    return import_electron.ipcRenderer.invoke("getMainWindowStats");
  },
  async getMenuOptions() {
    return import_electron.ipcRenderer.invoke("getMenuOptions");
  },
  async executeMenuAction(action) {
    return import_electron.ipcRenderer.invoke("executeMenuAction", action);
  }
};
window.SignalContext = SignalContext;
window.i18n = SignalContext.i18n;
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  SignalContext
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiY29udGV4dC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLy8gQ29weXJpZ2h0IDIwMjEgU2lnbmFsIE1lc3NlbmdlciwgTExDXG4vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQUdQTC0zLjAtb25seVxuXG5pbXBvcnQgeyBpcGNSZW5kZXJlciB9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCB0eXBlIHsgTWVudUl0ZW1Db25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICdlbGVjdHJvbic7XG5cbmltcG9ydCB0eXBlIHsgTWVudU9wdGlvbnNUeXBlLCBNZW51QWN0aW9uVHlwZSB9IGZyb20gJy4uL3R5cGVzL21lbnUnO1xuaW1wb3J0IHR5cGUgeyBJUENFdmVudHNWYWx1ZXNUeXBlIH0gZnJvbSAnLi4vdXRpbC9jcmVhdGVJUENFdmVudHMnO1xuaW1wb3J0IHR5cGUgeyBMb2NhbGl6ZXJUeXBlIH0gZnJvbSAnLi4vdHlwZXMvVXRpbCc7XG5pbXBvcnQgdHlwZSB7IExvZ2dlclR5cGUgfSBmcm9tICcuLi90eXBlcy9Mb2dnaW5nJztcbmltcG9ydCB0eXBlIHsgTG9jYWxlTWVzc2FnZXNUeXBlIH0gZnJvbSAnLi4vdHlwZXMvSTE4Tic7XG5pbXBvcnQgdHlwZSB7IE5hdGl2ZVRoZW1lVHlwZSB9IGZyb20gJy4uL2NvbnRleHQvY3JlYXRlTmF0aXZlVGhlbWVMaXN0ZW5lcic7XG5pbXBvcnQgdHlwZSB7IFNldHRpbmdUeXBlIH0gZnJvbSAnLi4vdXRpbC9wcmVsb2FkJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXJDb25maWdUeXBlIH0gZnJvbSAnLi4vdHlwZXMvUmVuZGVyZXJDb25maWcnO1xuXG5pbXBvcnQgeyBCeXRlcyB9IGZyb20gJy4uL2NvbnRleHQvQnl0ZXMnO1xuaW1wb3J0IHsgQ3J5cHRvIH0gZnJvbSAnLi4vY29udGV4dC9DcnlwdG8nO1xuaW1wb3J0IHsgVGltZXJzIH0gZnJvbSAnLi4vY29udGV4dC9UaW1lcnMnO1xuXG5pbXBvcnQgeyBzZXR1cEkxOG4gfSBmcm9tICcuLi91dGlsL3NldHVwSTE4bic7XG5pbXBvcnQge1xuICBnZXRFbnZpcm9ubWVudCxcbiAgcGFyc2VFbnZpcm9ubWVudCxcbiAgc2V0RW52aXJvbm1lbnQsXG59IGZyb20gJy4uL2Vudmlyb25tZW50JztcbmltcG9ydCB7IHN0cmljdEFzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IGNyZWF0ZVNldHRpbmcgfSBmcm9tICcuLi91dGlsL3ByZWxvYWQnO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZSBhcyBpbml0aWFsaXplTG9nZ2luZyB9IGZyb20gJy4uL2xvZ2dpbmcvc2V0X3VwX3JlbmRlcmVyX2xvZ2dpbmcnO1xuaW1wb3J0IHsgd2FpdEZvclNldHRpbmdzQ2hhbmdlIH0gZnJvbSAnLi93YWl0Rm9yU2V0dGluZ3NDaGFuZ2UnO1xuaW1wb3J0IHsgY3JlYXRlTmF0aXZlVGhlbWVMaXN0ZW5lciB9IGZyb20gJy4uL2NvbnRleHQvY3JlYXRlTmF0aXZlVGhlbWVMaXN0ZW5lcic7XG5pbXBvcnQgeyBpc1dpbmRvd3MsIGlzV2luZG93czExLCBpc0xpbnV4LCBpc01hY09TIH0gZnJvbSAnLi4vT1MnO1xuXG5jb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCk7XG5jb25zdCBjb25maWdQYXJhbSA9IHBhcmFtcy5nZXQoJ2NvbmZpZycpO1xuc3RyaWN0QXNzZXJ0KHR5cGVvZiBjb25maWdQYXJhbSA9PT0gJ3N0cmluZycsICdjb25maWcgaXMgbm90IGEgc3RyaW5nJyk7XG5jb25zdCBjb25maWcgPSBKU09OLnBhcnNlKGNvbmZpZ1BhcmFtKTtcblxuY29uc3QgeyBsb2NhbGUgfSA9IGNvbmZpZztcbnN0cmljdEFzc2VydChsb2NhbGUsICdsb2NhbGUgY291bGQgbm90IGJlIHBhcnNlZCBmcm9tIGNvbmZpZycpO1xuc3RyaWN0QXNzZXJ0KHR5cGVvZiBsb2NhbGUgPT09ICdzdHJpbmcnLCAnbG9jYWxlIGlzIG5vdCBhIHN0cmluZycpO1xuXG5jb25zdCBsb2NhbGVNZXNzYWdlcyA9IGlwY1JlbmRlcmVyLnNlbmRTeW5jKCdsb2NhbGUtZGF0YScpO1xuc2V0RW52aXJvbm1lbnQocGFyc2VFbnZpcm9ubWVudChjb25maWcuZW52aXJvbm1lbnQpKTtcblxuc3RyaWN0QXNzZXJ0KEJvb2xlYW4od2luZG93LlNpZ25hbENvbnRleHQpLCAnY29udGV4dCBtdXN0IGJlIGRlZmluZWQnKTtcblxuaW5pdGlhbGl6ZUxvZ2dpbmcoKTtcblxuZXhwb3J0IHR5cGUgTWFpbldpbmRvd1N0YXRzVHlwZSA9IFJlYWRvbmx5PHtcbiAgaXNNYXhpbWl6ZWQ6IGJvb2xlYW47XG4gIGlzRnVsbFNjcmVlbjogYm9vbGVhbjtcbn0+O1xuXG5leHBvcnQgdHlwZSBTaWduYWxDb250ZXh0VHlwZSA9IHtcbiAgYnl0ZXM6IEJ5dGVzO1xuICBjcnlwdG86IENyeXB0bztcbiAgdGltZXJzOiBUaW1lcnM7XG4gIG5hdGl2ZVRoZW1lTGlzdGVuZXI6IE5hdGl2ZVRoZW1lVHlwZTtcbiAgc2V0SXNDYWxsQWN0aXZlOiAoaXNDYWxsQWN0aXZlOiBib29sZWFuKSA9PiB1bmtub3duO1xuXG4gIFNldHRpbmdzOiB7XG4gICAgdGhlbWVTZXR0aW5nOiBTZXR0aW5nVHlwZTxJUENFdmVudHNWYWx1ZXNUeXBlWyd0aGVtZVNldHRpbmcnXT47XG4gICAgd2FpdEZvckNoYW5nZTogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgfTtcbiAgT1M6IHtcbiAgICBwbGF0Zm9ybTogc3RyaW5nO1xuICAgIGlzV2luZG93czogdHlwZW9mIGlzV2luZG93cztcbiAgICBpc1dpbmRvd3MxMTogdHlwZW9mIGlzV2luZG93czExO1xuICAgIGlzTGludXg6IHR5cGVvZiBpc0xpbnV4O1xuICAgIGlzTWFjT1M6IHR5cGVvZiBpc01hY09TO1xuICB9O1xuICBjb25maWc6IFJlbmRlcmVyQ29uZmlnVHlwZTtcbiAgZ2V0QXBwSW5zdGFuY2U6ICgpID0+IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgZ2V0RW52aXJvbm1lbnQ6ICgpID0+IHN0cmluZztcbiAgZ2V0Tm9kZVZlcnNpb246ICgpID0+IHN0cmluZztcbiAgZ2V0VmVyc2lvbjogKCkgPT4gc3RyaW5nO1xuICBnZXRQYXRoOiAobmFtZTogJ3VzZXJEYXRhJyB8ICdob21lJykgPT4gc3RyaW5nO1xuICBpMThuOiBMb2NhbGl6ZXJUeXBlO1xuICBsb2NhbGVNZXNzYWdlczogTG9jYWxlTWVzc2FnZXNUeXBlO1xuICBsb2c6IExvZ2dlclR5cGU7XG4gIHJlbmRlcldpbmRvdz86ICgpID0+IHZvaWQ7XG4gIGV4ZWN1dGVNZW51Um9sZTogKHJvbGU6IE1lbnVJdGVtQ29uc3RydWN0b3JPcHRpb25zWydyb2xlJ10pID0+IFByb21pc2U8dm9pZD47XG4gIGdldE1haW5XaW5kb3dTdGF0czogKCkgPT4gUHJvbWlzZTxNYWluV2luZG93U3RhdHNUeXBlPjtcbiAgZ2V0TWVudU9wdGlvbnM6ICgpID0+IFByb21pc2U8TWVudU9wdGlvbnNUeXBlPjtcbiAgZXhlY3V0ZU1lbnVBY3Rpb246IChhY3Rpb246IE1lbnVBY3Rpb25UeXBlKSA9PiBQcm9taXNlPHZvaWQ+O1xufTtcblxuZXhwb3J0IGNvbnN0IFNpZ25hbENvbnRleHQ6IFNpZ25hbENvbnRleHRUeXBlID0ge1xuICBTZXR0aW5nczoge1xuICAgIHRoZW1lU2V0dGluZzogY3JlYXRlU2V0dGluZygndGhlbWVTZXR0aW5nJywgeyBzZXR0ZXI6IGZhbHNlIH0pLFxuICAgIHdhaXRGb3JDaGFuZ2U6IHdhaXRGb3JTZXR0aW5nc0NoYW5nZSxcbiAgfSxcbiAgT1M6IHtcbiAgICBwbGF0Zm9ybTogcHJvY2Vzcy5wbGF0Zm9ybSxcbiAgICBpc1dpbmRvd3MsXG4gICAgaXNXaW5kb3dzMTEsXG4gICAgaXNMaW51eCxcbiAgICBpc01hY09TLFxuICB9LFxuICBieXRlczogbmV3IEJ5dGVzKCksXG4gIGNvbmZpZyxcbiAgY3J5cHRvOiBuZXcgQ3J5cHRvKCksXG4gIGdldEFwcEluc3RhbmNlOiAoKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+XG4gICAgY29uZmlnLmFwcEluc3RhbmNlID8gU3RyaW5nKGNvbmZpZy5hcHBJbnN0YW5jZSkgOiB1bmRlZmluZWQsXG4gIGdldEVudmlyb25tZW50LFxuICBnZXROb2RlVmVyc2lvbjogKCk6IHN0cmluZyA9PiBTdHJpbmcoY29uZmlnLm5vZGVWZXJzaW9uKSxcbiAgZ2V0VmVyc2lvbjogKCk6IHN0cmluZyA9PiBTdHJpbmcoY29uZmlnLnZlcnNpb24pLFxuICBnZXRQYXRoOiAobmFtZTogJ3VzZXJEYXRhJyB8ICdob21lJyk6IHN0cmluZyA9PiB7XG4gICAgcmV0dXJuIFN0cmluZyhjb25maWdbYCR7bmFtZX1QYXRoYF0pO1xuICB9LFxuICBpMThuOiBzZXR1cEkxOG4obG9jYWxlLCBsb2NhbGVNZXNzYWdlcyksXG4gIGxvY2FsZU1lc3NhZ2VzLFxuICBsb2c6IHdpbmRvdy5TaWduYWxDb250ZXh0LmxvZyxcbiAgbmF0aXZlVGhlbWVMaXN0ZW5lcjogY3JlYXRlTmF0aXZlVGhlbWVMaXN0ZW5lcihpcGNSZW5kZXJlciwgd2luZG93KSxcbiAgc2V0SXNDYWxsQWN0aXZlKGlzQ2FsbEFjdGl2ZTogYm9vbGVhbik6IHZvaWQge1xuICAgIGlwY1JlbmRlcmVyLnNlbmQoJ3NldC1pcy1jYWxsLWFjdGl2ZScsIGlzQ2FsbEFjdGl2ZSk7XG4gIH0sXG4gIHRpbWVyczogbmV3IFRpbWVycygpLFxuICBhc3luYyBleGVjdXRlTWVudVJvbGUoXG4gICAgcm9sZTogTWVudUl0ZW1Db25zdHJ1Y3Rvck9wdGlvbnNbJ3JvbGUnXVxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBpcGNSZW5kZXJlci5pbnZva2UoJ2V4ZWN1dGVNZW51Um9sZScsIHJvbGUpO1xuICB9LFxuICBhc3luYyBnZXRNYWluV2luZG93U3RhdHMoKTogUHJvbWlzZTxNYWluV2luZG93U3RhdHNUeXBlPiB7XG4gICAgcmV0dXJuIGlwY1JlbmRlcmVyLmludm9rZSgnZ2V0TWFpbldpbmRvd1N0YXRzJyk7XG4gIH0sXG4gIGFzeW5jIGdldE1lbnVPcHRpb25zKCk6IFByb21pc2U8TWVudU9wdGlvbnNUeXBlPiB7XG4gICAgcmV0dXJuIGlwY1JlbmRlcmVyLmludm9rZSgnZ2V0TWVudU9wdGlvbnMnKTtcbiAgfSxcbiAgYXN5bmMgZXhlY3V0ZU1lbnVBY3Rpb24oYWN0aW9uOiBNZW51QWN0aW9uVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBpcGNSZW5kZXJlci5pbnZva2UoJ2V4ZWN1dGVNZW51QWN0aW9uJywgYWN0aW9uKTtcbiAgfSxcbn07XG5cbndpbmRvdy5TaWduYWxDb250ZXh0ID0gU2lnbmFsQ29udGV4dDtcbndpbmRvdy5pMThuID0gU2lnbmFsQ29udGV4dC5pMThuO1xuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0Esc0JBQTRCO0FBWTVCLG1CQUFzQjtBQUN0QixvQkFBdUI7QUFDdkIsb0JBQXVCO0FBRXZCLHVCQUEwQjtBQUMxQix5QkFJTztBQUNQLG9CQUE2QjtBQUM3QixxQkFBOEI7QUFDOUIscUNBQWdEO0FBQ2hELG1DQUFzQztBQUN0Qyx1Q0FBMEM7QUFDMUMsZ0JBQXlEO0FBRXpELE1BQU0sU0FBUyxJQUFJLGdCQUFnQixTQUFTLFNBQVMsTUFBTTtBQUMzRCxNQUFNLGNBQWMsT0FBTyxJQUFJLFFBQVE7QUFDdkMsZ0NBQWEsT0FBTyxnQkFBZ0IsVUFBVSx3QkFBd0I7QUFDdEUsTUFBTSxTQUFTLEtBQUssTUFBTSxXQUFXO0FBRXJDLE1BQU0sRUFBRSxXQUFXO0FBQ25CLGdDQUFhLFFBQVEsd0NBQXdDO0FBQzdELGdDQUFhLE9BQU8sV0FBVyxVQUFVLHdCQUF3QjtBQUVqRSxNQUFNLGlCQUFpQiw0QkFBWSxTQUFTLGFBQWE7QUFDekQsdUNBQWUseUNBQWlCLE9BQU8sV0FBVyxDQUFDO0FBRW5ELGdDQUFhLFFBQVEsT0FBTyxhQUFhLEdBQUcseUJBQXlCO0FBRXJFLCtDQUFrQjtBQXlDWCxNQUFNLGdCQUFtQztBQUFBLEVBQzlDLFVBQVU7QUFBQSxJQUNSLGNBQWMsa0NBQWMsZ0JBQWdCLEVBQUUsUUFBUSxNQUFNLENBQUM7QUFBQSxJQUM3RCxlQUFlO0FBQUEsRUFDakI7QUFBQSxFQUNBLElBQUk7QUFBQSxJQUNGLFVBQVUsUUFBUTtBQUFBLElBQ2xCO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDRjtBQUFBLEVBQ0EsT0FBTyxJQUFJLG1CQUFNO0FBQUEsRUFDakI7QUFBQSxFQUNBLFFBQVEsSUFBSSxxQkFBTztBQUFBLEVBQ25CLGdCQUFnQixNQUNkLE9BQU8sY0FBYyxPQUFPLE9BQU8sV0FBVyxJQUFJO0FBQUEsRUFDcEQ7QUFBQSxFQUNBLGdCQUFnQixNQUFjLE9BQU8sT0FBTyxXQUFXO0FBQUEsRUFDdkQsWUFBWSxNQUFjLE9BQU8sT0FBTyxPQUFPO0FBQUEsRUFDL0MsU0FBUyxDQUFDLFNBQXNDO0FBQzlDLFdBQU8sT0FBTyxPQUFPLEdBQUcsV0FBVztBQUFBLEVBQ3JDO0FBQUEsRUFDQSxNQUFNLGdDQUFVLFFBQVEsY0FBYztBQUFBLEVBQ3RDO0FBQUEsRUFDQSxLQUFLLE9BQU8sY0FBYztBQUFBLEVBQzFCLHFCQUFxQixnRUFBMEIsNkJBQWEsTUFBTTtBQUFBLEVBQ2xFLGdCQUFnQixjQUE2QjtBQUMzQyxnQ0FBWSxLQUFLLHNCQUFzQixZQUFZO0FBQUEsRUFDckQ7QUFBQSxFQUNBLFFBQVEsSUFBSSxxQkFBTztBQUFBLFFBQ2IsZ0JBQ0osTUFDZTtBQUNmLFVBQU0sNEJBQVksT0FBTyxtQkFBbUIsSUFBSTtBQUFBLEVBQ2xEO0FBQUEsUUFDTSxxQkFBbUQ7QUFDdkQsV0FBTyw0QkFBWSxPQUFPLG9CQUFvQjtBQUFBLEVBQ2hEO0FBQUEsUUFDTSxpQkFBMkM7QUFDL0MsV0FBTyw0QkFBWSxPQUFPLGdCQUFnQjtBQUFBLEVBQzVDO0FBQUEsUUFDTSxrQkFBa0IsUUFBdUM7QUFDN0QsV0FBTyw0QkFBWSxPQUFPLHFCQUFxQixNQUFNO0FBQUEsRUFDdkQ7QUFDRjtBQUVBLE9BQU8sZ0JBQWdCO0FBQ3ZCLE9BQU8sT0FBTyxjQUFjOyIsCiAgIm5hbWVzIjogW10KfQo=
